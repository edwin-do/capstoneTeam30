\documentclass[12pt, titlepage]{article}

\usepackage{amsmath, mathtools}

\usepackage[round]{natbib}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{colortbl}
\usepackage{xr}
\usepackage{hyperref}
\usepackage{longtable}
\usepackage{xfrac}
\usepackage{tabularx}
\usepackage{float}
\usepackage{siunitx}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage[section]{placeins}
\usepackage{caption}
\usepackage{fullpage}

\hypersetup{
bookmarks=true,     % show bookmarks bar?
colorlinks=true,       % false: boxed links; true: colored links
linkcolor=red,          % color of internal links (change box color with linkbordercolor)
citecolor=blue,      % color of links to bibliography
filecolor=magenta,  % color of file links
urlcolor=cyan          % color of external links
}

\usepackage{array}

\externaldocument{../../SRS/SRS}

\input{../../Comments}
\input{../../Common}

\begin{document}

\title{Module Interface Specification for \progname{}}

\author{\authname}

\date{\today}

\maketitle

\pagenumbering{roman}

\section{Revision History}

\begin{tabularx}{\textwidth}{p{3cm}p{2cm}X}
\toprule {\bf Date} & {\bf Developer} & {\bf Notes}\\
\midrule
Jan 17, 2023 & Timothy Chen & Added Modules to Module Decomposition\\
Jan 18, 2023 & Timothy Chen & Added Current State Module \\
Jan 18, 2023 & Timothy Chen & Added File Output Module \\
Jan 18, 2023 & Timothy Chen & Added Graphical Output Module \\
Jan 18 2023 & Edwin Do & Added MIS info for UserInputValidation, HardwareInputValidation, and Calculation Modules\\
Jan 18 2023 & Edwin Do & Added state invariants\\
Jan 18 2023 & Tyler Magarelli & Added Input Communication Module\\
Jan 18 2023 & Tyler Magarelli & Added Output Communication Module\\
Jan 18 2023 & Tyler Magarelli & Added Remote Access Module\\
Apr 5 2023 & Edwin Do & Updated with revised modules\\
\bottomrule
\end{tabularx}

~\newpage

\section{Symbols, Abbreviations, and Acronyms}

See SRS Documentation at \href{https://github.com/edwin-do/capstoneTeam30/blob/main/docs/SRS/SRS.pdf}{here}.

% \wss{Also add any additional symbols, abbreviations or acronyms}

\newpage

\tableofcontents

\newpage

\pagenumbering{arabic}

\section{Introduction}

\noindent The following document details the Module Interface Specifications for Measuring Microstructure Changes During Thermal Treatment. This project will allow the Materials Engineering lab at McMaster University, led by Dr. Zurob, to use software capable of providing data on thermally treated metals. The data includes measurements of the resistivity of the material as well as graphical representations and analysis. \\

\noindent Complementary documents include the System Requirement Specifications and Module Guide. The full documentation and implementation can be found at our \href{https://github.com/edwin-do/capstoneTeam30}{GitHub repository}.

\section{Notation}

The structure of the MIS for modules comes from \citet{HoffmanAndStrooper1995},
with the addition that template modules have been adapted from
\cite{GhezziEtAl2003}.  The mathematical notation comes from Chapter 3 of
\citet{HoffmanAndStrooper1995}.  For instance, the symbol := is used for a
multiple assignment statement and conditional rules follow the form $(c_1
\Rightarrow r_1 | c_2 \Rightarrow r_2 | ... | c_n \Rightarrow r_n )$.

The following table summarizes the primitive data types used by \progname. 

\begin{center}
\renewcommand{\arraystretch}{1.2}
\noindent 
\begin{tabular}{l l p{7.5cm}} 
\toprule 
\textbf{Data Type} & \textbf{Notation} & \textbf{Description}\\ 
\midrule
character & char & a single symbol or digit\\
integer & $\mathbb{Z}$ & a number without a fractional component in (-$\infty$, $\infty$) \\
natural number & $\mathbb{N}$ & a number without a fractional component in [1, $\infty$) \\
Real & $\mathbb{R}$ & any number in (-$\infty$, $\infty$)\\
\bottomrule
\end{tabular} 
\end{center}

\noindent
The specification of \progname \ uses some derived data types: sequences, strings, and
tuples. Sequences are lists filled with elements of the same data type. Strings
are sequences of characters. Tuples contain a list of values, potentially of
different types. In addition, \progname \ uses functions, which
are defined by the data types of their inputs and outputs. Local functions are
described by giving their type signature followed by their specification.

\newpage
\section{Module Decomposition}

The following table is taken directly from the Module Guide document for this project.

\begin{table}[h!]
\centering
\begin{tabular}{p{0.3\textwidth} p{0.6\textwidth}}
\toprule
\textbf{Level 1} & \textbf{Level 2}\\
\midrule

{Hardware-Hiding} & ~ \\
\midrule

\multirow{7}{0.3\textwidth}{Behaviour-Hiding}
% & Input Communication Module (\ref{IC})\\
& Remote Access Module (\ref{RA})\\
& Current State Module (\ref{CS})\\ 
& FileOutput Module (\ref{FO})\\
& Graphical Output Module (\ref{GO})\\
\midrule

\multirow{3}{0.3\textwidth}{Software Decision} 
& Calculation Module (\ref{C})\\
& User Input Validation Module (\ref{UI})\\
& Instrument Input Validation Module (\ref{HI})\\
\bottomrule
\end{tabular}
\caption{Module Hierarchy}
\label{TblMH}
\end{table}


\clearpage
\newpage
\section{MIS of Remote Access Module} \label{RA} 

\subsection{Module}

Remote Access Module

\subsection{Uses}
CurrentState Module \\
Microsoft.Extensions.Hosting
\subsubsection{Imported Types}
IHost

\subsubsection{Imported Access Program}
RemoteGetCurrentStatus() \\
RemoteGetExperimentStatus() \\
RemoteTurnCurrentOn() \\
RemoteTurnCurrentOff() \\
RemoteStartCapture() \\
RemoteStopCapture() \\

\subsection{Syntax}

\subsubsection{Exported Constants}
N/A
\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{7cm} p{3cm} p{1cm} p{3cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
StartServer(host) & IHost & - & INVALID \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

N/A

\subsubsection{State Invariant}

N/A

\subsubsection{Environment Variables}
MainWindow
ServerStatus 

\subsubsection{Assumptions}
Hosting will occur only on port 5100 \\
StartServer() is called before any other routine

\subsubsection{Access Routine Semantics}
\noindent StartServer():
\begin{itemize}
\item transition: ServerStatus := FALSE $\rightarrow$ ServerStatus := TRUE
\item exception: $exc:=$ PortNotAvailable $\lor$ PortAlreadyInUse  $\Rightarrow INVALID$
\end{itemize}

\subsubsection{Local Functions}

N/A

\newpage
\section{MIS of Current State Module} \label{CS} 

\subsection{Module}

Current State Module (MainWindow)

\subsection{Uses}
File Output Module \\
Calculation Module \\
Instrument Input Validation Module \\
User Input Validation Module \\
Remote Access Module \\

\subsubsection{Imported Types}

HardwareInput:
( $Voltage: \mathbb{R} $ ; $Time: \mathbb{R}$; $Temperature: \mathbb{R}$; $Current: \mathbb{R}$, $Resistance: \mathbb{R} $ ; $Resistivity: \mathbb{R} $ ;)\\

\noindent InstrumentInput:
( $CurrentLevel: \mathbb{R} $ ; $Compliance: \mathbb{R}$; $SampleRate: \mathbb{R}$; $JuncTemperature: \mathbb{R}$; string: Range; string ThType)\\

\noindent {UserInput:}
( UserSampleThickness: $\mathbb{R}$; UserSampleLength: $\mathbb{R}$; UserSampleWidth: $\mathbb{R}$; UserName: $string$; UserSampleName: $string$)

\subsubsection{Imported Access Programs}

StartServer(): void\\
CheckSampleRate(r) : bool\\
CheckCurrentLevel(c) : bool  \\
CheckCompliance(c): bool \\
CheckJuncTemperature(t): bool\\
CalcResistance(): $\mathbb{R}$ \\
CalcResistivity(): $\mathbb{R}$ \\
CalcTemperature(): $\mathbb{R}$ \\
CalcAperture(): string \\
checkUserInput(): UserInput\\
checkInputBox(): bool \\
validateUserData(): bool \\


\subsection{Syntax}

\subsubsection{Exported Constants}
N/A

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{7cm} p{3cm} p{1cm} p{3cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
 RemoteGetCurrentStatus() & - & bool & INVALID \\
 RemoteGetExperimentStatus() & - & bool & INVALID \\
 RemoteTurnCurrentOn() & - & - & INVALID \\
 RemoteTurnCurrentOff() & - & - & INVALID \\
 RemoteStartCapture() & - & - & INVALID \\
 RemoteStopCapture() & - & - & INVALID \\

\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

ExperimentStatus: bool

\subsubsection{State Invariant}

N/A

\subsubsection{Environment Variables}
DeviceVoltageRate: The sampling rate setting on the connected nanovoltmeter\\
DeviceTemperature: The temperature setting on the connected multimeter\\
DeviceCurrentLevel: The current level setting on the connected current source\\
DeviceCompliance: The compliance setting on the connected current source\\
DeviceCurrentOutput: The output setting on the connected current source \\

\subsubsection{Assumptions}

InitializeComponent() is called before any other access program

\subsubsection{Access Routine Semantics}

\noindent RemoteGetCurrentStatus():
\begin{itemize}
\item output: The status of current output from current source (bool)
\item exception: none
\end{itemize}

\noindent RemoteGetExperimentStatus():
\begin{itemize}
\item output: The status of the experiment (bool)
\item exception: none
\end{itemize}

\noindent RemoteTurnCurrentOn():
\begin{itemize}
\item transition: Turns the connected current output on
\item exception: none
\end{itemize}

\noindent RemoteTurnCurrentOff():
\begin{itemize}
\item transition: Turns the connected current output off
\item exception: none
\end{itemize}

\noindent RemoteStartCapture():
\begin{itemize}
\item transition: Starts the experiment to capture data
\item exception: none
\end{itemize}

\noindent RemoteStopCapture():
\begin{itemize}
\item transition: Stops the experiment from capturing data
\item exception: none
\end{itemize}


\subsubsection{Local Functions}

\noindent InitializeComponent():
\begin{itemize}
\item transition: State is initialized on MainWindow
\item exception: none
\end{itemize}

\noindent InitializeCurrentSource():
\begin{itemize}
\item transition: Address of Current Source is found and connected
\item exception: none
\end{itemize}

\noindent InitializeNanoVoltmeter():
\begin{itemize}
\item transition: Address of Nano Voltmeter is found and connected
\item exception: none
\end{itemize}

\noindent InitializeMultimeter():
\begin{itemize}
\item transition: Address of Multimeter is found and connected
\item exception: none
\end{itemize}

\noindent SetVoltRate(rate):
\begin{itemize}
\item transition: DeviceVoltageRate = rate
\item exception: if CheckSampleRate = FALSE $\rightarrow$ INVALID
\end{itemize}

\noindent SetJuncTemp(temp):
\begin{itemize}
\item transition: DeviceTemperature = temp
\item exception: if CheckJuncTemp = FALSE $\rightarrow$ INVALID
\end{itemize}

\noindent SetCurrent(current):
\begin{itemize}
\item transition: DeviceCurrentLevel = current
\item exception: if CheckCurrentLevel = FALSE $\rightarrow$ INVALID
\end{itemize}

\noindent ToggleCurrentOutput():
\begin{itemize}
\item transition: DeviceCurrentOutput = !DeviceCurrentOutput
\item exception: N/A
\end{itemize}

\noindent StartCapture():
\begin{itemize}
\item transition: ExperimentStatus = TRUE
\item exception: N/A
\end{itemize}

\noindent StopCapture():
\begin{itemize}
\item transition: ExperimentStatus = FALSE
\item exception: N/A
\end{itemize}

\newpage

\section{MIS of FileOutput Module} \label{FO} 

\subsection{Module}

FileOutput Module

\subsection{Uses}

\subsubsection{Imported Types}

HardwareInput: ( $Voltage: \mathbb{R} $ ; $Time: \mathbb{R}$; $Temperature: \mathbb{R}$; $Current: \mathbb{R}$ )\\
UserInput: ( $SamplingRate: \mathbb{R}$; $SampleLength: \mathbb{R}$; $SampleWidth: \mathbb{R}$; $Filename: string$ $Name: string$; $SampleName: string$; $Date: string$)

\subsubsection{Imported Access Programs}
  GetResistivity(): $\mathbb{R}$\\
  GetResistance():$\mathbb{R}$\\
  GetUserInput(): UserInput\\
  GetHardwareInput(): HardwareInput

\subsection{Syntax}

\subsubsection{Exported Constants}

N/A

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{4cm} p{6cm} p{2cm} p{3cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
FileInit() & - & FileOutput & - \\
GetFilePath() & - & string &  -\\
WriteUserInput() & string, string, string, $\mathbb{R}, \mathbb{R}, \mathbb{R}$&  & INVALID \\
WriteSampleOutput()& $\mathbb{R}, \mathbb{R}, \mathbb{R}, \mathbb{R}, \mathbb{R}, \mathbb{R}$ & record & INVALID \\

\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

N/A
\subsubsection{State Invariant}

N/A
\subsubsection{Environment Variables}

OutputFile: a .csv file used to store data such as the user inputs and hardware outputs

\subsubsection{Assumptions}

FileOutput() is called and initialized before any other access program. 

\subsubsection{Access Routine Semantics}

\noindent FileOutput(filePath):
\begin{itemize}
\item transition: Initializes a FileOutput instance
\item exception: INVALID
\end{itemize}

\noindent GetFilePath():
\begin{itemize}
\item Output: string
\item exception: N/A
\end{itemize}

\noindent WriteUserInput(Name, SampleName, Date, SamplingRate, SampleLength, SampleWidth):
\begin{itemize}
\item Transition: Write user input into the first line of the OutputFile 
\item exception: $exc:= SamplingRate \notin \mathbb{R} \lor SamplingRate < 0 \lor SampleLength \notin \mathbb{R} \lor SampleLength < 0 \lor SampleWidth \notin \mathbb{R} \lor SampleWidth < 0 \Rightarrow INVALID$
\end{itemize}

\noindent WriteSampleOutput(Time, Temperature, Voltage, Current, Resistance, Resistivity):
\begin{itemize}
\item Transition: Write each data set into the OutputFile at each time interval
\item exception: $exc:= Time \notin  \mathbb{R} \lor Time < 0 \lor  Temperature \notin  \mathbb{R} \lor Voltage < 0 \lor  Voltage \notin  \mathbb{R} \lor Current < 0 \lor  Current \notin  \mathbb{R} \lor Resistance < 0 \lor  Resistance \notin  \mathbb{R} \lor Resistivity < 0\lor  Resistance \notin  \mathbb{R} \lor Resistivity < 0\Rightarrow INVALID$
\end{itemize}

\subsubsection{Local Functions}

N/A

\newpage

\section{MIS of Graphical Output Module} \label{GO} 

\subsection{Module}

File Output Module

\subsection{Uses}
SyncFusion Charts API (3rd Party)

\subsubsection{Imported Types}
SyncFusion - SfChart \\
SyncFusion - DataGrid

\subsubsection{Imported Access Programs}

\subsection{Syntax}

\subsubsection{Exported Constants}

N/A

\subsubsection{Exported Access Programs}
N/A

\subsection{Semantics}

\subsubsection{State Variables}

N/A

\subsubsection{State Invariant}

N/A

\subsubsection{Environment Variables}

MainWindow: The application interface where the information displayed to the user

\subsubsection{Assumptions}

initializeChart() is called before any other access program

\subsubsection{Access Routine Semantics}

\noindent initializeChart():
\begin{itemize}
\item transition: Graph is initialized on MainWindow and data source is binded correctly.
\item exception: none
\end{itemize}

\subsubsection{Local Functions}

N/A

\newpage


\section{MIS of Calculation Module} \label{C} 

\subsection{Module}

Calculation Module

\subsection{Uses}

\subsubsection{Imported Types}
N/A
% HardwareInput: \\
% ( $Voltage: \mathbb{R} $ ; $Time: \mathbb{R}$; $Temperature: \mathbb{R}$; $Current: \mathbb{R}$ )\\

% \noindent{UserInput:} \\
% ( $SamplingRate: \mathbb{R}$; $SampleLength: \mathbb{R}$; $SampleWidth: \mathbb{R}$; $Filename: string$; $Name: string$; $SampleName: string$; $Date: string$)

\subsubsection{Imported Access Programs}
% getHardwareInput(): HardwareInput \\
% getUserInput(): UserInput
N/A

\subsection{Syntax}

\subsubsection{Exported Constants}
N/A

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{4cm} p{5cm} p{3cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
CalcResistance() & $\mathbb{R}$,$\mathbb{R}$ & $\mathbb{R}$ & - \\
CalcResistivity() & $\mathbb{R}$,$\mathbb{R}$,$\mathbb{R}$ & $\mathbb{R}$ & - \\
CalcTemperature() & $\mathbb{R}$,$\mathbb{R}$, int, $\mathbb{R}$ & $\mathbb{R}$ & - \\
CalcAperture() & $\mathbb{R}$ & string & - \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

Resistance : The calculated resistance value ($\mathbb{R}$)\\
Resistivity : The calculated resistivity value ($\mathbb{R}$) \\
SampleArea : The calculated area of the sample based on the length and width from the user's input

\subsubsection{State Invariants}

Resistance $\geq 0$ \\
Resistivity $\geq 0$ \\
SampleArea $\geq 0$

\subsubsection{Environment Variables}

N/A

\subsubsection{Assumptions}

We assume that the user may enter invalid values for inputs such as characters, empty spaces, etc...
This type of error is captured in the UserInputValidation Module.

\subsubsection{Access Routine Semantics}

\noindent CalcResistance(voltage, current):
\begin{itemize}
\item output: out:= (voltage/current) $\mathbb{R}$
\item exception: $exc:= Resistance \notin \mathbb{R} \lor Resistance < 0  \Rightarrow INVALID$
\end{itemize}

\noindent CalcResistivity(resistance, area, length):
\begin{itemize}
\item output: out := (resistance $\cdot$ area /length) $\mathbb{R}$
\item exception: $exc:= Resistivity \notin \mathbb{R} \lor Resistivity < 0  \Rightarrow INVALID$
\end{itemize}

\noindent CalcTemperature(volt, junc\_temp, type, temperature):
\begin{itemize}
\item output: out := $\mathbb{R}$
\item exception: $exc:= Temperature \notin \mathbb{R}  \Rightarrow INVALID$
\end{itemize}

\noindent CalcAperture(rate):
\begin{itemize}
\item output: out := string
\item exception: $exc:=$ Aperture is not string $\Rightarrow INVALID$
\end{itemize}


\subsubsection{Local Functions}
N/A
\newpage

\section{MIS of UserInputValidation Module} \label{UI} 



\subsection{Module}

UserInputValidation Module

\subsection{Uses}

\subsubsection{Imported Types}

\noindent{UserInput:} \\
( UserSampleThickness: $\mathbb{R}$; UserSampleLength: $\mathbb{R}$; UserSampleWidth: $\mathbb{R}$; UserName: $string$; UserSampleName: $string$)

\subsection{Syntax}

\subsubsection{Exported Constants}
N/A

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{4cm} p{6cm} p{3cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
checkUserInput() & string,string,$\mathbb{R}$,$\mathbb{R}$,$\mathbb{R}$ & UserInput & INVALID \\
checkInputBox() & string & bool & INVALID \\
validateUserData() & string,string,$\mathbb{R}$,$\mathbb{R}$,$\mathbb{R}$ & bool & INVALID \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
N/A

\subsubsection{State Invariants}
N/A

\subsubsection{Environment Variables}

N/A

\subsubsection{Assumptions}
We assume that the user may enter invalid values for inputs such as characters, empty spaces, etc...
This will cause the program to throw an INVALID exception.

\subsubsection{Access Routine Semantics}

\noindent checkUserInput(userName, userSampleName, userSampleLength, userSampleWidth, userSampleThickness):
\begin{itemize}
\item output: out:= UserInput
\item exception: $exc:= 
validateUserData \ne TRUE
\Rightarrow INVALID$
\end{itemize}

\noindent checkInputBox(input):
\begin{itemize}
\item output: out:= bool
\item exception: $exc:= 
input = EMPTY \lor input = NULL
\Rightarrow INVALID$
\end{itemize}

\noindent validateUserData(userName, userSampleName, userSampleLength, userSampleWidth, userSampleThickness):
\begin{itemize}
\item output: out:= bool
\item exception: $exc:= 
 (userName \lor userSampleName is NOT string ) \lor
 (userSampleLength \le 0 \lor userSampleWidth \le 0 \lor userSampleThickness \le 0) \\
\Rightarrow INVALID$
\end{itemize}

\subsubsection{Local Functions}
N/A
\newpage


\section{MIS of InstrumentInputValidation Module} \label{HI}
\subsection{Module}

InstrumentInputValidation Module

\subsection{Uses}

\subsubsection{Imported Types}
N/A

\subsection{Syntax}

\subsubsection{Exported Constants}
N/A

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{6cm} p{2cm} p{3cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
CheckSampleRate(r) & $\mathbb{R}$ & bool & INVALID \\
CheckCurrentLevel(c) & $\mathbb{R}$ & bool & INVALID \\
CheckCompliance(c) & $\mathbb{R}$ & bool & INVALID \\
CheckJuncTemperature(t) & $\mathbb{R}$ & bool & INVALID \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}
N/A

\subsubsection{State Invariants}
N/A

\subsubsection{Environment Variables}

N/A

\subsubsection{Assumptions}
N/A

\subsubsection{Access Routine Semantics}

\noindent CheckSampleRate(r):
\begin{itemize}
\item output: out:= bool
\item exception: $exc:= 
r > 600 \lor r < 1 \
\Rightarrow INVALID$
\end{itemize}

\noindent CheckCurrentLevel(c):
\begin{itemize}
\item output: out:= bool
\item exception: $exc:= 
c < -105 \lor c > 105 \lor c = 0 \
\Rightarrow INVALID$
\end{itemize}

\noindent CheckCompliance(c):
\begin{itemize}
\item output: out:= bool
\item exception: $exc:= 
c > 105 \lor c < -0.1 \
\Rightarrow INVALID$
\end{itemize}

\noindent CheckJuncTemperature(t):
\begin{itemize}
\item output: out:= bool
\item exception: $exc:= 
t > 9999 \lor t < -9999 \
\Rightarrow INVALID$
\end{itemize}


\subsubsection{Local Functions}
N/A
\newpage

\bibliographystyle {plainnat}
\bibliography {../../../refs/References}

\newpage

\section{Appendix} \label{Appendix}

\end{document}